<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>高考志愿推荐系统</title>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #69cee0 0%, #a8e6cf 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #69cee0 0%, #5fb3c4 100%);
            color: white;
            padding: 30px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(105, 206, 224, 0.3);
        }
        
        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
            font-weight: 300;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.1);
        }

        .header p {
            font-size: 16px;
            opacity: 0.95;
            font-weight: 300;
        }
        
        .content {
            padding: 30px;
        }
        
        .form-section {
            background: linear-gradient(135deg, #f0fdff 0%, #e8f8f5 100%);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 1px solid rgba(105, 206, 224, 0.2);
            box-shadow: 0 2px 15px rgba(105, 206, 224, 0.1);
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-group label {
            font-weight: 500;
            color: #2c3e50;
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        .form-group input,
        .form-group select {
            padding: 12px;
            border: 2px solid rgba(105, 206, 224, 0.3);
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.8);
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #69cee0;
            box-shadow: 0 0 0 3px rgba(105, 206, 224, 0.1);
            background: white;
        }
        
        .submit-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #69cee0 0%, #5fb3c4 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(105, 206, 224, 0.3);
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(105, 206, 224, 0.4);
        }

        .submit-btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #69cee0;
            font-size: 18px;
            font-weight: 300;
        }
        
        .error {
            background: linear-gradient(135deg, #ffe6e6 0%, #ffcccc 100%);
            color: #c0392b;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            border-left: 4px solid #e74c3c;
            box-shadow: 0 2px 10px rgba(231, 76, 60, 0.1);
        }
        
        .result-section {
            margin-top: 30px;
        }
        
        .user-info {
            background: linear-gradient(135deg, #69cee0 0%, #5fb3c4 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 4px 20px rgba(105, 206, 224, 0.2);
        }



        .user-position-marker {
            position: absolute;
            background: #ff6b6b;
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
            z-index: 10;
            box-shadow: 0 2px 8px rgba(255, 107, 107, 0.3);
        }

        .school-tags {
            display: flex;
            gap: 5px;
            margin-left: 10px;
            flex-wrap: wrap;
        }

        .school-tag {
            background: linear-gradient(135deg, #69cee0, #5fb3c4);
            color: white;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 11px;
            font-weight: 500;
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
            box-shadow: 0 2px 5px rgba(105, 206, 224, 0.2);
        }

        .school-tag.tag-985 {
            background: linear-gradient(135deg, #ff7675, #fd79a8);
        }

        .school-tag.tag-211 {
            background: linear-gradient(135deg, #00b894, #00cec9);
        }

        .school-tag.tag-double-first-class {
            background: linear-gradient(135deg, #6c5ce7, #a29bfe);
        }

        .school-name-container {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8fdff 100%);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(105, 206, 224, 0.1);
            border: 1px solid rgba(105, 206, 224, 0.1);
        }

        .stat-number {
            font-size: 28px;
            font-weight: 300;
            color: #69cee0;
        }

        .stat-label {
            color: #7f8c8d;
            margin-top: 5px;
            font-weight: 300;
        }
        
        .school-category {
            margin-bottom: 30px;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 6px 20px rgba(105, 206, 224, 0.1);
            border: 1px solid rgba(105, 206, 224, 0.1);
        }

        .category-header {
            padding: 20px;
            color: white;
            font-size: 20px;
            font-weight: 300;
            text-align: center;
        }

        .rush .category-header {
            background: linear-gradient(135deg, #ff7675, #fd79a8);
        }

        .stable .category-header {
            background: linear-gradient(135deg, #00b894, #00cec9);
        }

        .safe .category-header {
            background: linear-gradient(135deg, #69cee0, #a8e6cf);
        }
        
        .schools-container {
            background: linear-gradient(135deg, #ffffff 0%, #f8fdff 100%);
            padding: 20px;
            border-radius: 0 0 15px 15px;
        }

        .school-card {
            background: linear-gradient(135deg, #ffffff 0%, #f0fdff 100%);
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 12px;
            border-left: 4px solid #69cee0;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(105, 206, 224, 0.1);
        }

        .school-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(105, 206, 224, 0.2);
        }

        .rush .school-card {
            border-left-color: #ff7675;
        }

        .stable .school-card {
            border-left-color: #00b894;
        }

        .safe .school-card {
            border-left-color: #69cee0;
        }
        
        .school-name {
            font-size: 18px;
            font-weight: 500;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .school-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .info-item {
            background: rgba(255, 255, 255, 0.8);
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 14px;
            border: 1px solid rgba(105, 206, 224, 0.1);
        }

        .info-label {
            font-weight: 500;
            color: #7f8c8d;
        }

        .probability {
            text-align: center;
            padding: 12px;
            border-radius: 10px;
            font-weight: 500;
            margin-bottom: 10px;
        }

        .prob-high {
            background: linear-gradient(135deg, #d1f2eb 0%, #a3e4d7 100%);
            color: #00695c;
        }

        .prob-medium {
            background: linear-gradient(135deg, #fef9e7 0%, #fcf3cf 100%);
            color: #b7950b;
        }

        .prob-low {
            background: linear-gradient(135deg, #fadbd8 0%, #f5b7b1 100%);
            color: #a93226;
        }
        
        .recommendation {
            background: linear-gradient(135deg, #e8f8f5 0%, #d5f4e6 100%);
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #69cee0;
            font-style: italic;
            color: #2c3e50;
            font-weight: 300;
        }
        
        .hidden {
            display: none;
        }

        /* 展开/收起功能样式 */
        .category-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            padding: 15px 20px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 12px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
            user-select: none;
        }

        .category-header:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        /* 不同分类的悬停效果 - 使用对应颜色的深色版本 */
        .rush .category-header:hover {
            background: linear-gradient(135deg, #e84393, #fd79a8);
        }

        .stable .category-header:hover {
            background: linear-gradient(135deg, #00a085, #00b894);
        }

        .safe .category-header:hover {
            background: linear-gradient(135deg, #5fb3c4, #69cee0);
        }

        .category-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
        }

        .toggle-button {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            color: #69cee0;
            font-weight: 500;
        }

        .toggle-icon {
            font-size: 1.2rem;
            transition: transform 0.3s ease;
        }

        .toggle-icon.expanded {
            transform: rotate(180deg);
        }

        .schools-container {
            transition: all 0.4s ease;
            overflow: hidden;
        }

        .schools-container.collapsed {
            max-height: 0;
            opacity: 0;
            margin-top: -15px;
        }

        .schools-container.expanded {
            max-height: none;
            opacity: 1;
        }

        /* 默认显示前3所学校 */
        .schools-container.preview {
            max-height: 400px;
            overflow: hidden;
            position: relative;
        }

        .schools-container.preview::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: linear-gradient(transparent, rgba(255,255,255,0.9));
            pointer-events: none;
        }

        /* 科目选择样式 */
        .subject-selection-container {
            margin: 20px 0;
        }

        .subject-selection {
            background: linear-gradient(135deg, #f0fdff 0%, #e8f8f5 100%);
            border: 1px solid rgba(105, 206, 224, 0.2);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.4s ease;
        }

        .subject-selection.changing {
            opacity: 0.7;
            transform: scale(0.98);
        }

        .subject-title {
            color: #2c3e50;
            font-weight: 500;
            margin-bottom: 15px;
            font-size: 16px;
        }

        .subject-group {
            margin-bottom: 15px;
        }

        .subject-group-title {
            color: #7f8c8d;
            font-size: 14px;
            margin-bottom: 8px;
            font-weight: 400;
        }

        .subject-options {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .subject-option {
            display: inline-block;
            padding: 8px 16px;
            border: 2px solid rgba(105, 206, 224, 0.3);
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.8);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            user-select: none;
        }

        .subject-option:hover {
            border-color: #69cee0;
            background: rgba(105, 206, 224, 0.1);
            transform: translateY(-1px);
        }

        .subject-option.selected {
            background: linear-gradient(135deg, #69cee0, #5fb3c4);
            color: white;
            border-color: #69cee0;
            animation: selectPulse 0.3s ease;
        }

        .subject-option.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            pointer-events: none;
        }

        .validation-hint {
            color: #e74c3c;
            font-size: 12px;
            margin-top: 10px;
            display: none;
        }

        .validation-hint.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes selectPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* 学校详情悬停提示框样式 */
        .school-detail-tooltip {
            position: fixed;
            z-index: 10000;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15);
            border: 1px solid rgba(105, 206, 224, 0.2);
            width: 350px;
            max-height: 500px;
            overflow: hidden;
            opacity: 0;
            transform: translateY(10px) scale(0.95);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            pointer-events: none;
            backdrop-filter: blur(10px);
        }

        .school-detail-tooltip.show {
            opacity: 1;
            transform: translateY(0) scale(1);
            pointer-events: auto;
        }

        .school-detail-header {
            background: linear-gradient(135deg, #69cee0, #5fb3c4);
            color: white;
            padding: 16px 20px;
            border-radius: 12px 12px 0 0;
        }

        .school-detail-title-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 4px;
        }

        .school-detail-title {
            font-size: 16px;
            font-weight: 600;
            line-height: 1.3;
            flex: 1;
        }

        .school-detail-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            margin-left: 10px;
        }

        .school-detail-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .school-detail-btn:active {
            transform: translateY(0);
        }

        .school-detail-subtitle {
            font-size: 13px;
            opacity: 0.9;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .school-detail-content {
            max-height: 420px;
            overflow-y: auto;
            padding: 0;
        }

        .school-detail-content::-webkit-scrollbar {
            width: 6px;
        }

        .school-detail-content::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }

        .school-detail-content::-webkit-scrollbar-thumb {
            background: #69cee0;
            border-radius: 3px;
        }

        .school-detail-content::-webkit-scrollbar-thumb:hover {
            background: #5fb3c4;
        }

        .detail-section {
            padding: 16px 20px;
            border-bottom: 1px solid #f0f0f0;
        }

        .detail-section:last-child {
            border-bottom: none;
        }

        .detail-section-title {
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .detail-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 8px;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 8px 12px;
            background: rgba(105, 206, 224, 0.05);
            border-radius: 6px;
            font-size: 13px;
            line-height: 1.4;
            border-left: 3px solid rgba(105, 206, 224, 0.3);
        }

        .detail-label {
            color: #555;
            font-weight: 600;
            min-width: 70px;
            margin-right: 12px;
        }

        .detail-value {
            color: #333;
            flex: 1;
            text-align: right;
            word-break: break-word;
            font-weight: 500;
        }

        .detail-value.empty {
            color: #999;
            font-style: italic;
            font-weight: normal;
        }

        .detail-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 4px;
        }

        .detail-tag {
            background: linear-gradient(135deg, #69cee0, #5fb3c4);
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
        }

        .detail-tag.tag-985 {
            background: linear-gradient(135deg, #ff7675, #fd79a8);
        }

        .detail-tag.tag-211 {
            background: linear-gradient(135deg, #00b894, #00cec9);
        }

        .detail-tag.tag-double-first-class {
            background: linear-gradient(135deg, #6c5ce7, #a29bfe);
        }

        .detail-text-item {
            margin-bottom: 16px;
        }

        .detail-text-item:last-child {
            margin-bottom: 0;
        }

        .detail-text-label {
            color: #555;
            font-weight: 600;
            font-size: 13px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .detail-description {
            color: #666;
            line-height: 1.6;
            font-size: 13px;
            text-align: justify;
            background: rgba(105, 206, 224, 0.03);
            padding: 12px;
            border-radius: 6px;
            border-left: 3px solid rgba(105, 206, 224, 0.2);
        }

        .detail-empty {
            color: #999;
            font-style: italic;
            font-size: 12px;
            text-align: center;
            padding: 20px;
            background: rgba(0,0,0,0.02);
            border-radius: 6px;
        }

        /* 学校卡片悬停状态 */
        .school-card {
            position: relative;
        }

        .school-card.tooltip-active {
            z-index: 1;
        }

        /* 响应式设计 */
        @media (max-width: 768px) {
            .subject-options {
                gap: 6px;
            }

            .subject-option {
                padding: 6px 12px;
                font-size: 13px;
            }

            .school-detail-tooltip {
                width: 300px;
                max-height: 400px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🎯 高考志愿推荐系统</h1>
            <p>基于历年录取数据，为您推荐最适合的大学</p>
        </div>
        
        <div class="content">
            <div class="form-section">
                <h2 style="margin-bottom: 20px; color: #2c3e50; font-weight: 300;">📝 请输入您的信息</h2>
                <form id="recommendationForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="userScore">高考分数</label>
                            <input type="number" id="userScore" placeholder="请输入您的高考分数" min="0" max="750" required>
                        </div>
                        <div class="form-group">
                            <label for="provinceId">省份</label>
                            <select id="provinceId" required onchange="onProvinceChange()">
                                <option value="">请选择省份</option>
                                <option value="22">安徽</option>
                                <option value="15">福建</option>
                                <option value="24">甘肃</option>
                                <option value="19">广东</option>
                                <option value="23">广西</option>
                                <option value="1">河南</option>
                                <option value="9">黑龙江</option>
                                <option value="16">湖北</option>
                                <option value="17">湖南</option>
                                <option value="8">江西</option>
                                <option value="25">宁夏</option>
                                <option value="7">山西</option>
                                <option value="5">陕西</option>
                                <option value="27">四川</option>
                                <option value="29">新疆</option>
                                <option value="26">云南</option>
                                <option value="10">浙江</option>
                            </select>
                        </div>
                    </div>

                    <!-- 动态科目选择区域 -->
                    <div id="subjectSelectionContainer" class="subject-selection-container hidden">
                        <div class="subject-selection">
                            <div class="subject-title">📚 科目选择</div>
                            <div id="subjectContent">
                                <!-- 动态内容将在这里生成 -->
                            </div>
                            <div id="validationHint" class="validation-hint"></div>
                        </div>
                    </div>

                    <div class="form-grid">

                        <div class="form-group">
                            <label for="schoolType">学校类型（可选）</label>
                            <select id="schoolType">
                                <option value="">不限制</option>
                                <option value="综合">综合类</option>
                                <option value="理工">理工类</option>
                                <option value="师范">师范类</option>
                                <option value="医药">医药类</option>
                                <option value="财经">财经类</option>
                            </select>
                        </div>
                    </div>
                    <button type="submit" class="submit-btn" id="submitBtn">
                        🔍 获取推荐
                    </button>
                </form>
            </div>
            
            <div id="loadingDiv" class="loading hidden">
                <div>🔄 正在分析您的分数，推荐合适的学校...</div>
            </div>
            
            <div id="errorDiv" class="error hidden"></div>
            
            <div id="resultDiv" class="result-section hidden">
                <div id="userInfo" class="user-info"></div>
                <div id="statsDiv" class="stats-grid"></div>
                <div id="rushSchools" class="school-category rush"></div>
                <div id="stableSchools" class="school-category stable"></div>
                <div id="safeSchools" class="school-category safe"></div>
            </div>
        </div>
    </div>
    <script>
        // 显示加载状态
        function showLoading() {
            document.getElementById('loadingDiv').classList.remove('hidden');
            document.getElementById('errorDiv').classList.add('hidden');
            document.getElementById('resultDiv').classList.add('hidden');
            document.getElementById('submitBtn').disabled = true;
            document.getElementById('submitBtn').textContent = '🔄 推荐中...';
        }

        // 隐藏加载状态
        function hideLoading() {
            document.getElementById('loadingDiv').classList.add('hidden');
            document.getElementById('submitBtn').disabled = false;
            document.getElementById('submitBtn').textContent = '🔍 获取推荐';
        }

        // 显示错误信息
        function showError(message) {
            hideLoading();
            document.getElementById('errorDiv').classList.remove('hidden');
            document.getElementById('errorDiv').textContent = '❌ ' + message;
            document.getElementById('resultDiv').classList.add('hidden');
        }

        // 显示成功结果
        function showResult(data) {
            hideLoading();
            document.getElementById('errorDiv').classList.add('hidden');
            document.getElementById('resultDiv').classList.remove('hidden');

            // 显示用户信息
            const userInfo = data.userInfo || {};
            document.getElementById('userInfo').innerHTML = `
                <h3>📊 您的基本信息</h3>
                <p><strong>分数：</strong>${userInfo.userScore || '未知'}分 |
                   <strong>省份：</strong>${userInfo.provinceName || '未知'} |
                   <strong>科类：</strong>${userInfo.subjectCategoryName || '未知'}</p>
                <p><strong>预估位次：</strong>${userInfo.estimatedRank || '未知'}</p>

            `;



            // 显示统计信息
            const stats = data.statistics || {};
            document.getElementById('statsDiv').innerHTML = `
                <div class="stat-card">
                    <div class="stat-number">${stats.rushCount || 0}</div>
                    <div class="stat-label">冲刺学校</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${stats.stableCount || 0}</div>
                    <div class="stat-label">稳妥学校</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${stats.safeCount || 0}</div>
                    <div class="stat-label">保底学校</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${stats.totalCount || 0}</div>
                    <div class="stat-label">总推荐数</div>
                </div>
            `;

            // 显示各类学校
            displaySchools('rushSchools', '🚀 冲刺学校', data.rushSchools || []);
            displaySchools('stableSchools', '✅ 稳妥学校', data.stableSchools || []);
            displaySchools('safeSchools', '🛡️ 保底学校', data.safeSchools || []);
        }

        // 显示学校列表
        function displaySchools(containerId, title, schools) {
            const container = document.getElementById(containerId);

            if (!schools || schools.length === 0) {
                container.innerHTML = `
                    <div class="category-header" onclick="toggleCategory('${containerId}')">
                        <div class="category-title">${title} (0所)</div>
                        <div class="toggle-button">
                            <span>展开</span>
                            <span class="toggle-icon">▼</span>
                        </div>
                    </div>
                    <div class="schools-container collapsed" id="${containerId}-container">
                        <div style="text-align: center; color: #666; padding: 20px;">暂无推荐学校</div>
                    </div>
                `;
                return;
            }

            let schoolsHtml = schools.map(school => `
                <div class="school-card">
                    <div class="school-name-container">
                        <div class="school-name">${school.schoolName || '未知学校'}</div>
                        <div class="school-tags">${generateSchoolTags(school.tags)}</div>
                    </div>
                    <div class="school-info">
                        <div class="info-item">
                            <span class="info-label">类型：</span>
                            ${school.schoolType || '未知'}
                        </div>
                        <div class="info-item">
                            <span class="info-label">省份：</span>
                            ${school.schoolProvince || '未知'}
                        </div>
                        <div class="info-item">
                            <span class="info-label">历年最低分：</span>
                            ${school.historicalMinScore || '未知'}
                        </div>
                        <div class="info-item">
                            <span class="info-label">最低位次：</span>
                            ${school.historicalMinRank || '未知'}
                        </div>
                    </div>
                    <div class="probability ${getProbabilityClass(school.admissionProbability)}">
                        录取概率：${school.admissionProbability ? school.admissionProbability.toFixed(1) : '未知'}%
                    </div>
                    <div class="recommendation">
                        ${school.recommendationReason || '暂无推荐理由'}
                    </div>
                </div>
            `).join('');

            // 判断是否需要展开/收起功能（超过5所学校时启用）
            const needToggle = schools.length > 5;
            const initialState = needToggle ? 'collapsed' : 'expanded';
            const toggleText = needToggle ? '展开' : '';
            const toggleIcon = needToggle ? '▼' : '';

            container.innerHTML = `
                <div class="category-header" onclick="toggleCategory('${containerId}')">
                    <div class="category-title">${title} (${schools.length}所)</div>
                    ${needToggle ? `
                        <div class="toggle-button">
                            <span class="toggle-text">展开</span>
                            <span class="toggle-icon">▼</span>
                        </div>
                    ` : ''}
                </div>
                <div class="schools-container ${initialState}" id="${containerId}-container">
                    ${schoolsHtml}
                </div>
            `;

            // 为每个学校卡片添加悬停事件
            setTimeout(() => {
                const schoolCards = container.querySelectorAll('.school-card');
                schoolCards.forEach((card, index) => {
                    if (schools[index]) {
                        addSchoolTooltipEvents(card, schools[index]);
                    }
                });

                // 初始化提示框事件
                if (schoolTooltip) {
                    initTooltipEvents();
                }
            }, 100);
        }

        // 获取概率样式类
        function getProbabilityClass(probability) {
            if (!probability) return 'prob-low';
            if (probability >= 80) return 'prob-high';
            if (probability >= 50) return 'prob-medium';
            return 'prob-low';
        }

        // 切换分类展开/收起状态
        function toggleCategory(containerId) {
            const container = document.getElementById(containerId + '-container');
            const header = document.querySelector(`#${containerId} .category-header`);
            const toggleButton = header.querySelector('.toggle-button');

            if (!toggleButton) return; // 如果没有切换按钮，直接返回

            const toggleText = toggleButton.querySelector('.toggle-text');
            const toggleIcon = toggleButton.querySelector('.toggle-icon');

            if (container.classList.contains('collapsed')) {
                // 展开
                container.classList.remove('collapsed');
                container.classList.add('expanded');
                toggleText.textContent = '收起';
                toggleIcon.classList.add('expanded');
            } else {
                // 收起
                container.classList.remove('expanded');
                container.classList.add('collapsed');
                toggleText.textContent = '展开';
                toggleIcon.classList.remove('expanded');
            }
        }

        // 学校详情提示框相关变量
        let schoolTooltip = null;
        let tooltipTimeout = null;
        let hideTimeout = null;

        // 创建学校详情提示框
        function createSchoolTooltip() {
            if (schoolTooltip) return schoolTooltip;

            schoolTooltip = document.createElement('div');
            schoolTooltip.className = 'school-detail-tooltip';
            document.body.appendChild(schoolTooltip);

            // 添加事件监听器
            addTooltipEvents();
            schoolTooltip.hasEventListeners = true;

            return schoolTooltip;
        }

        // 显示学校详情提示框
        function showSchoolTooltip(schoolData, event) {
            // 清除隐藏定时器
            if (hideTimeout) {
                clearTimeout(hideTimeout);
                hideTimeout = null;
            }

            const tooltip = createSchoolTooltip();

            // 生成详情内容
            const content = generateSchoolDetailContent(schoolData);
            tooltip.innerHTML = content;

            // 计算位置 - 基于学校名称位置
            const schoolCard = event.target.closest('.school-card');
            const schoolNameElement = schoolCard.querySelector('.school-name');
            const rect = schoolNameElement ? schoolNameElement.getBoundingClientRect() : schoolCard.getBoundingClientRect();

            const tooltipWidth = 350;
            const tooltipHeight = Math.min(500, window.innerHeight - 40);

            // 默认显示在学校名称右侧
            let left = rect.right + 15;
            let top = rect.top - 10; // 稍微向上偏移，与名称对齐

            // 检查右侧空间，不足时显示在左侧
            if (left + tooltipWidth > window.innerWidth - 20) {
                left = rect.left - tooltipWidth - 15;
            }

            // 检查顶部空间
            if (top + tooltipHeight > window.innerHeight - 20) {
                top = window.innerHeight - tooltipHeight - 20;
            }

            // 确保不超出屏幕顶部
            if (top < 20) {
                top = 20;
            }

            tooltip.style.left = left + 'px';
            tooltip.style.top = top + 'px';

            // 显示提示框
            setTimeout(() => {
                tooltip.classList.add('show');
            }, 10);
        }

        // 隐藏学校详情提示框
        function hideSchoolTooltip() {
            if (hideTimeout) {
                clearTimeout(hideTimeout);
            }

            hideTimeout = setTimeout(() => {
                if (schoolTooltip) {
                    schoolTooltip.classList.remove('show');
                }
            }, 200);
        }

        // 省份ID到名称的映射
        const provinceMap = {
            1: '安徽省', 2: '福建省', 3: '甘肃省', 4: '广东省', 5: '广西壮族自治区',
            6: '上海市', 7: '贵州省', 8: '海南省', 9: '河北省', 10: '浙江省',
            11: '河南省', 12: '黑龙江省', 13: '湖北省', 14: '湖南省', 15: '吉林省',
            16: '江苏省', 17: '江西省', 18: '辽宁省', 19: '内蒙古自治区', 20: '北京市',
            21: '宁夏回族自治区', 22: '青海省', 23: '山东省', 24: '山西省', 25: '陕西省',
            26: '四川省', 27: '天津市', 28: '西藏自治区', 29: '新疆维吾尔自治区', 30: '云南省',
            31: '重庆市'
        };

        // 生成学校详情内容
        function generateSchoolDetailContent(school) {
            const tags = school.tags ? school.tags.split(',').filter(tag => tag.trim()) : [];
            const provinceName = provinceMap[school.provinceId] || '未知省份';
            const schoolName = school.schoolName || school.name || '未知学校';

            return `
                <div class="school-detail-header">
                    <div class="school-detail-title-row">
                        <div class="school-detail-title">${schoolName}</div>
                        <button class="school-detail-btn" onclick="searchSchoolWebsite('${schoolName}')" title="搜索学校官网">
                            详细
                        </button>
                    </div>
                    <div class="school-detail-subtitle">
                        <span>📍 ${provinceName}</span>
                        <span>🎓 ${school.schoolType || '未知类型'}</span>
                    </div>
                </div>
                <div class="school-detail-content">
                    ${generateBasicInfoSection(school, provinceName)}
                    ${generateAdmissionInfoSection(school)}
                    ${generateTagsSection(tags)}
                    ${generateProfessionsSection(school)}
                    ${generateIntroductionSection(school)}
                </div>
            `;
        }

        // 生成基本信息部分
        function generateBasicInfoSection(school, provinceName) {
            // 处理各种可能的字段名称，使用推荐API返回的字段名
            const schoolName = school.schoolName || school.name || '未知';
            const schoolLevel = school.schoolLevel || '未知';
            const ownershipType = school.ownershipType || '未知';
            const schoolType = school.schoolType || '未知';
            const schoolAffiliation = school.schoolAffiliation || '未知';

            return `
                <div class="detail-section">
                    <div class="detail-section-title">🏫 基本信息</div>
                    <div class="detail-grid">
                        <div class="detail-item">
                            <span class="detail-label">学校名称</span>
                            <span class="detail-value">${schoolName}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">办学层次</span>
                            <span class="detail-value">${schoolLevel}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">办学性质</span>
                            <span class="detail-value">${ownershipType}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">院校类型</span>
                            <span class="detail-value">${schoolType}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">隶属单位</span>
                            <span class="detail-value">${schoolAffiliation}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">所在省份</span>
                            <span class="detail-value">${provinceName}</span>
                        </div>
                    </div>
                </div>
            `;
        }

        // 生成录取信息部分
        function generateAdmissionInfoSection(school) {
            const minScore = school.historicalMinScore || '暂无数据';
            const minRank = school.historicalMinRank || '暂无数据';
            const probability = school.admissionProbability ? school.admissionProbability.toFixed(1) + '%' : '暂无数据';

            return `
                <div class="detail-section">
                    <div class="detail-section-title">📊 录取信息</div>
                    <div class="detail-grid">
                        <div class="detail-item">
                            <span class="detail-label">历年最低分</span>
                            <span class="detail-value ${minScore === '暂无数据' ? 'empty' : ''}">${minScore}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">最低位次</span>
                            <span class="detail-value ${minRank === '暂无数据' ? 'empty' : ''}">${minRank}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">录取概率</span>
                            <span class="detail-value ${probability === '暂无数据' ? 'empty' : ''}">${probability}</span>
                        </div>
                    </div>
                </div>
            `;
        }

        // 生成标签部分
        function generateTagsSection(tags) {
            if (!tags || tags.length === 0) {
                return `
                    <div class="detail-section">
                        <div class="detail-section-title">🏆 院校标签</div>
                        <div class="detail-empty">暂无特殊标签</div>
                    </div>
                `;
            }

            const tagElements = tags.map(tag => {
                const trimmedTag = tag.trim();
                let tagClass = 'detail-tag';

                if (trimmedTag === '985') tagClass += ' tag-985';
                else if (trimmedTag === '211') tagClass += ' tag-211';
                else if (trimmedTag === '双一流') tagClass += ' tag-double-first-class';

                return `<span class="${tagClass}">${trimmedTag}</span>`;
            }).join('');

            return `
                <div class="detail-section">
                    <div class="detail-section-title">🏆 院校标签</div>
                    <div class="detail-tags">${tagElements}</div>
                </div>
            `;
        }

        // 生成特色专业部分
        function generateProfessionsSection(school) {
            const hasProfessions = school.schoolNationalProfessions && school.schoolNationalProfessions.trim();

            if (!hasProfessions) {
                return `
                    <div class="detail-section">
                        <div class="detail-section-title">🎓 特色专业</div>
                        <div class="detail-empty">暂无特色专业信息</div>
                    </div>
                `;
            }

            // 处理特色专业，将分号分隔的专业转换为更好的显示格式
            const professions = school.schoolNationalProfessions
                .split(';')
                .filter(p => p.trim())
                .map(p => p.trim())
                .join('、');

            return `
                <div class="detail-section">
                    <div class="detail-section-title">🎓 特色专业</div>
                    <div class="detail-grid">
                        <div class="detail-text-item">
                            <div class="detail-description">${professions}</div>
                        </div>
                    </div>
                </div>
            `;
        }

        // 生成学校介绍部分
        function generateIntroductionSection(school) {
            const hasIntroduction = school.schoolIntroduction && school.schoolIntroduction.trim();

            if (!hasIntroduction) {
                return `
                    <div class="detail-section">
                        <div class="detail-section-title">📝 学校简介</div>
                        <div class="detail-empty">暂无学校简介信息</div>
                    </div>
                `;
            }

            // 截取简介的前500个字符，避免过长
            const introduction = school.schoolIntroduction.length > 500
                ? school.schoolIntroduction.substring(0, 500) + '...'
                : school.schoolIntroduction;

            return `
                <div class="detail-section">
                    <div class="detail-section-title">📝 学校简介</div>
                    <div class="detail-grid">
                        <div class="detail-text-item">
                            <div class="detail-description">${introduction}</div>
                        </div>
                    </div>
                </div>
            `;
        }

        // 为学校卡片添加悬停事件
        function addSchoolTooltipEvents(schoolCard, schoolData) {
            let isHovering = false;

            // 鼠标进入学校卡片
            schoolCard.addEventListener('mouseenter', function(e) {
                isHovering = true;

                // 清除之前的定时器
                if (tooltipTimeout) {
                    clearTimeout(tooltipTimeout);
                }

                // 0.8秒后显示提示框
                tooltipTimeout = setTimeout(() => {
                    if (isHovering) {
                        showSchoolTooltip(schoolData, e);
                        schoolCard.classList.add('tooltip-active');
                    }
                }, 800);
            });

            // 鼠标离开学校卡片
            schoolCard.addEventListener('mouseleave', function() {
                isHovering = false;

                // 清除显示定时器
                if (tooltipTimeout) {
                    clearTimeout(tooltipTimeout);
                    tooltipTimeout = null;
                }

                schoolCard.classList.remove('tooltip-active');

                // 延迟隐藏提示框
                hideSchoolTooltip();
            });
        }

        // 为提示框添加鼠标事件
        function addTooltipEvents() {
            if (!schoolTooltip) return;

            // 鼠标进入提示框
            schoolTooltip.addEventListener('mouseenter', function() {
                // 清除隐藏定时器
                if (hideTimeout) {
                    clearTimeout(hideTimeout);
                    hideTimeout = null;
                }
            });

            // 鼠标离开提示框
            schoolTooltip.addEventListener('mouseleave', function() {
                hideSchoolTooltip();
            });
        }

        // 初始化提示框事件（在创建提示框后调用）
        function initTooltipEvents() {
            if (schoolTooltip && !schoolTooltip.hasEventListeners) {
                addTooltipEvents();
                schoolTooltip.hasEventListeners = true;
            }
        }

        // 表单提交处理
        document.getElementById('recommendationForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            // 验证科目选择
            if (!validateSubjectSelection()) {
                return;
            }

            showLoading();

            try {
                // 获取表单数据
                const userScore = document.getElementById('userScore').value;
                const provinceId = document.getElementById('provinceId').value;
                const subjectCategoryId = getSubjectCategoryId(); // 使用动态计算的科类ID
                const schoolType = document.getElementById('schoolType').value;

                // 构建请求URL，默认使用2024年数据，不限制推荐数量
                let url = `/api/recommendations/basic?userScore=${userScore}&provinceId=${provinceId}&subjectCategoryId=${subjectCategoryId}&year=2024`;
                if (schoolType) url += `&schoolType=${schoolType}`;

                console.log('请求URL:', url);

                // 发送请求
                const response = await fetch(url);

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const result = await response.json();
                console.log('响应结果:', result);

                if (result.code === 200) {
                    showResult(result.data);
                } else {
                    showError(`请求失败：${result.message || '未知错误'}`);
                }

            } catch (error) {
                console.error('请求错误:', error);
                showError(`网络错误：${error.message}`);
            }
        });

        // 生成学校标签HTML
        function generateSchoolTags(tags) {
            if (!tags) return '';

            const tagList = tags.split(',').map(tag => tag.trim()).filter(tag => tag);
            return tagList.map(tag => {
                let tagClass = 'school-tag';
                let tagText = tag;

                if (tag === '985') {
                    tagClass += ' tag-985';
                    tagText = '985';
                } else if (tag === '211') {
                    tagClass += ' tag-211';
                    tagText = '211';
                } else if (tag === '双一流' || tag === '双一流大学') {
                    tagClass += ' tag-double-first-class';
                    tagText = '双一流';
                }

                return `<span class="${tagClass}">${tagText}</span>`;
            }).join('');
        }





        // 省份考试类型缓存（从API动态获取）
        const provinceExamTypes = {};

        // 当前选择的科目
        let selectedSubjects = [];
        let currentExamType = null;

        // 省份改变时的处理函数
        async function onProvinceChange() {
            const provinceId = document.getElementById('provinceId').value;
            const container = document.getElementById('subjectSelectionContainer');

            if (!provinceId) {
                container.classList.add('hidden');
                return;
            }

            try {
                // 从缓存获取或从API获取省份考试类型
                let examType = provinceExamTypes[provinceId];
                if (examType === undefined) {
                    examType = await getProvinceExamType(provinceId);
                    provinceExamTypes[provinceId] = examType; // 缓存结果
                }

                currentExamType = examType;
                selectedSubjects = [];

                // 显示科目选择区域
                container.classList.remove('hidden');

                // 根据考试类型生成不同的选择界面
                generateSubjectSelection(examType);

            } catch (error) {
                console.error('获取省份考试类型失败:', error);
                showValidationHint('获取省份信息失败，请重试');
                container.classList.add('hidden');
            }
        }

        // 从API获取省份考试类型
        async function getProvinceExamType(provinceId) {
            try {
                const response = await fetch(`/api/test/provinces`);
                if (!response.ok) {
                    throw new Error('网络请求失败');
                }

                const result = await response.json();
                if (result.code !== 200 || !result.data) {
                    throw new Error('API返回错误');
                }

                // 查找对应省份的考试类型
                const province = result.data.find(p => p.id == provinceId);
                if (!province) {
                    throw new Error('省份不存在');
                }

                // 根据数据库中的provinceExamType映射到前端的考试模式
                // 0: 新高考3+3模式 → 0 (浙江、上海、北京、天津、海南、山东)
                // 1: 新高考3+1+2模式 → 1 (大部分省份)
                // 2: 传统文理分科 → 2 (新疆、西藏等少数省份)

                if (province.provinceExamType === 0) {
                    return 0; // 3+3模式：浙江、上海、北京、天津、海南、山东
                } else if (province.provinceExamType === 1) {
                    return 1; // 3+1+2模式：湖北、湖南、广东、福建、江苏、河北、辽宁、重庆、河南、山西、陕西、安徽、江西、黑龙江、吉林、广西、四川、贵州、云南、甘肃、宁夏、青海等
                } else {
                    return 2; // 传统文理分科：新疆、西藏等
                }

            } catch (error) {
                console.error('获取省份考试类型失败:', error);
                // 默认返回文理分科模式
                return 2;
            }
        }

        // 生成科目选择界面
        function generateSubjectSelection(examType) {
            const content = document.getElementById('subjectContent');
            const selection = document.querySelector('.subject-selection');

            // 添加切换动画
            selection.classList.add('changing');

            setTimeout(() => {
                let html = '';

                if (examType === 1) {
                    // 3+1+2模式
                    html = `
                        <div class="subject-group">
                            <div class="subject-group-title">首选科目 (必选一门)</div>
                            <div class="subject-options">
                                <div class="subject-option" data-subject="physics" data-type="primary" onclick="selectSubject(this)">物理</div>
                                <div class="subject-option" data-subject="history" data-type="primary" onclick="selectSubject(this)">历史</div>
                            </div>
                        </div>
                        <div class="subject-group">
                            <div class="subject-group-title">再选科目 (任选两门)</div>
                            <div class="subject-options">
                                <div class="subject-option" data-subject="chemistry" data-type="secondary" onclick="selectSubject(this)">化学</div>
                                <div class="subject-option" data-subject="biology" data-type="secondary" onclick="selectSubject(this)">生物</div>
                                <div class="subject-option" data-subject="geography" data-type="secondary" onclick="selectSubject(this)">地理</div>
                                <div class="subject-option" data-subject="politics" data-type="secondary" onclick="selectSubject(this)">思想政治</div>
                            </div>
                        </div>
                    `;
                } else if (examType === 0) {
                    // 3+3模式
                    html = `
                        <div class="subject-group">
                            <div class="subject-group-title">选考科目 (任选三门)</div>
                            <div class="subject-options">
                                <div class="subject-option" data-subject="physics" data-type="elective" onclick="selectSubject(this)">物理</div>
                                <div class="subject-option" data-subject="chemistry" data-type="elective" onclick="selectSubject(this)">化学</div>
                                <div class="subject-option" data-subject="biology" data-type="elective" onclick="selectSubject(this)">生物</div>
                                <div class="subject-option" data-subject="history" data-type="elective" onclick="selectSubject(this)">历史</div>
                                <div class="subject-option" data-subject="geography" data-type="elective" onclick="selectSubject(this)">地理</div>
                                <div class="subject-option" data-subject="politics" data-type="elective" onclick="selectSubject(this)">思想政治</div>
                            </div>
                        </div>
                    `;
                } else if (examType === 2) {
                    // 文理分科模式
                    html = `
                        <div class="subject-group">
                            <div class="subject-group-title">科类选择</div>
                            <div class="subject-options">
                                <div class="subject-option" data-subject="science" data-type="category" onclick="selectSubject(this)">理科</div>
                                <div class="subject-option" data-subject="liberal" data-type="category" onclick="selectSubject(this)">文科</div>
                            </div>
                        </div>
                    `;
                }

                content.innerHTML = html;
                selection.classList.remove('changing');

                // 清除验证提示
                hideValidationHint();
            }, 200);
        }

        // 选择科目
        function selectSubject(element) {
            const subject = element.dataset.subject;
            const type = element.dataset.type;

            if (currentExamType === 1) {
                // 3+1+2模式
                if (type === 'primary') {
                    // 首选科目，单选
                    document.querySelectorAll('[data-type="primary"]').forEach(el => el.classList.remove('selected'));
                    element.classList.add('selected');
                    selectedSubjects = selectedSubjects.filter(s => !['physics', 'history'].includes(s));
                    selectedSubjects.push(subject);
                } else if (type === 'secondary') {
                    // 再选科目，最多选2门
                    const secondarySelected = selectedSubjects.filter(s => ['chemistry', 'biology', 'geography', 'politics'].includes(s));

                    if (element.classList.contains('selected')) {
                        element.classList.remove('selected');
                        selectedSubjects = selectedSubjects.filter(s => s !== subject);
                    } else if (secondarySelected.length < 2) {
                        element.classList.add('selected');
                        selectedSubjects.push(subject);
                    } else {
                        showValidationHint('再选科目最多只能选择2门');
                        return;
                    }
                }
            } else if (currentExamType === 0) {
                // 3+3模式，最多选3门
                if (element.classList.contains('selected')) {
                    element.classList.remove('selected');
                    selectedSubjects = selectedSubjects.filter(s => s !== subject);
                } else if (selectedSubjects.length < 3) {
                    element.classList.add('selected');
                    selectedSubjects.push(subject);
                } else {
                    showValidationHint('选考科目最多只能选择3门');
                    return;
                }
            } else if (currentExamType === 2) {
                // 文理分科，单选
                document.querySelectorAll('[data-type="category"]').forEach(el => el.classList.remove('selected'));
                element.classList.add('selected');
                selectedSubjects = [subject];
            }

            hideValidationHint();
            console.log('当前选择的科目:', selectedSubjects);
        }

        // 显示验证提示
        function showValidationHint(message) {
            const hint = document.getElementById('validationHint');
            hint.textContent = message;
            hint.classList.add('show');
        }

        // 隐藏验证提示
        function hideValidationHint() {
            const hint = document.getElementById('validationHint');
            hint.classList.remove('show');
        }

        // 获取科类ID（根据选择的科目判断）
        function getSubjectCategoryId() {
            // 如果选择了物理，返回1（理科类）
            if (selectedSubjects.includes('physics') || selectedSubjects.includes('science')) {
                return 1;
            }
            // 否则返回2（历史类/文科类）
            return 2;
        }

        // 验证科目选择是否完整
        function validateSubjectSelection() {
            if (!currentExamType || selectedSubjects.length === 0) {
                showValidationHint('请选择科目');
                return false;
            }

            if (currentExamType === 1) {
                // 3+1+2模式：需要选择1门首选科目和2门再选科目
                const hasPrimary = selectedSubjects.some(s => ['physics', 'history'].includes(s));
                const secondaryCount = selectedSubjects.filter(s => ['chemistry', 'biology', 'geography', 'politics'].includes(s)).length;

                if (!hasPrimary) {
                    showValidationHint('请选择首选科目（物理或历史）');
                    return false;
                }
                if (secondaryCount !== 2) {
                    showValidationHint('请选择2门再选科目');
                    return false;
                }
            } else if (currentExamType === 0) {
                // 3+3模式：需要选择3门科目
                if (selectedSubjects.length !== 3) {
                    showValidationHint('请选择3门选考科目');
                    return false;
                }
            } else if (currentExamType === 2) {
                // 文理分科：需要选择1门
                if (selectedSubjects.length !== 1) {
                    showValidationHint('请选择文科或理科');
                    return false;
                }
            }

            return true;
        }

        // 搜索学校官网
        function searchSchoolWebsite(schoolName) {
            // 构建搜索查询，添加"官网"关键词以提高搜索精度
            const searchQuery = encodeURIComponent(`${schoolName}`);
            // 使用百度搜索（在中国更常用）
            const searchUrl = `https://www.baidu.com/s?wd=${searchQuery}`;
            // 在新标签页中打开搜索结果
            window.open(searchUrl, '_blank');
        }

    </script>
</body>
</html>
